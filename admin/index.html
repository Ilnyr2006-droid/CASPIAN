<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CASPIAN — Кровельные и строительные материалы</title>

  <!-- Netlify Identity -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- ======= ТВОЙ САЙТ (контент) ======= -->
  <header>
    <h1>CASPIAN</h1>
  </header>

  <main>
    <p>Главная страница сайта</p>
  </main>
  <!-- ======= /ТВОЙ САЙТ ======= -->


  <!-- ======= ЛОГИКА ДЛЯ NETLIFY IDENTITY ======= -->
  <script>
    (function () {
      const hash = window.location.hash || "";

      // Если пришли из письма Netlify (invite / recovery / confirmation)
      if (
        hash.includes("invite_token=") ||
        hash.includes("recovery_token=") ||
        hash.includes("confirmation_token=")
      ) {
        // Перенаправляем строго в /admin с сохранением токена
        window.location.replace("/admin/" + hash);
        return;
      }

      // Если пользователь уже залогинен — можно сразу пустить в админку
      if (window.netlifyIdentity) {
        window.netlifyIdentity.on("init", (user) => {
          if (user && window.location.pathname !== "/admin/") {
            console.log("User logged in:", user.email);
          }
        });
      }
    })();
  </script>
  <!-- ======= /ЛОГИКА ======= -->

</body>
</html>
